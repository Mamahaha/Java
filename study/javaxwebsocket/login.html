<html>
<head>
    <script src="jquery-1.10.1.min.js"></script>
    <script src="cookie.js"></script>
    <script type="text/javascript">
        function setMessageInnerHTML(innerHTML){
            document.getElementById('message').innerHTML += innerHTML + '<br/>';
        }

        function httpLogin() {
            //setMessageInnerHTML("Login start");
            var userValue = $('#user').val();
            var passwordValue = $('#password').val();

            var xmlhttp;
            if (window.XMLHttpRequest) {
                // code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp=new XMLHttpRequest();
            }
            else {
                // code for IE6, IE5
                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange=function() {
                //setMessageInnerHTML("Login " + xmlhttp.readyState + "; " + xmlhttp.status + "; " + userValue + "; " + xmlhttp.responseText);
                if (xmlhttp.readyState==4 && xmlhttp.status==200) {
                    var result = xmlhttp.responseText;
                    if (result != null || result != undefined || result != "") {
                        setMessageInnerHTML("Login successfully");
                        setCookie("user", userValue, 10, "/");
                        setCookie("password", passwordValue, 10, "/");
                        setCookie("session", result, 10, "/");
                    } else {
                        setMessageInnerHTML("Login failed" + result);
                    }
                }
            }

            var url = "http://192.168.116.153:8080/login?user=" + userValue + "&password=" + passwordValue;
            xmlhttp.open("POST", url, true);
            //xmlhttp.open("POST", "http://127.0.0.1:8080/login?user=xtp&password=xtp", true);
            xmlhttp.send();
        }

        function getSession() {
            var sessionValue = getCookieValue("session");
            setMessageInnerHTML(sessionValue);
        }
    </script>

</head>
<body>
    <div id="message"></div>
    <p>
        <span>Username:</span>
        <input id="user" type="text" value=""/></p>
    <p>
        <span>Password:</span>
        <input id="password" type="password" value=""/></p>
    <p>

    <button type="button"  onclick="httpLogin()">login</button>
    <button type="button" onclick="getSession()">session</button>
    <button type="button" onclick="connectws()">connect websocket</button>
</body>
</html>
